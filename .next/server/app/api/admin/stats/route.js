"use strict";(()=>{var e={};e.id=6553,e.ids=[6553],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},99654:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>v,routeModule:()=>b,serverHooks:()=>q,staticGenerationAsyncStorage:()=>I});var s={};r.r(s),r.d(s,{GET:()=>f});var a=r(49303),n=r(88716),o=r(60670),i=r(87070),u=r(57258),p=r(25163),c=r(6308),d=r(12757),m=r(11185);let y=new m.Schema({question:{type:String,required:!0},answer:{type:String},categoryId:{type:m.Schema.Types.ObjectId,ref:"Category"},subcategoryId:{type:m.Schema.Types.ObjectId,ref:"Subcategory"},position:{type:String},organization:{type:String},year:{type:Number}},{timestamps:!0}),l=m.models.PastInterview||m.model("PastInterview",y);var g=r(48412);async function S(){try{await (0,p.Z)();let e=await c.Z.countDocuments(),t=await d.Z.countDocuments(),r=await l.countDocuments(),s=await g.Z.countDocuments();return{success:!0,data:{mcqs:e,pastPapers:t,pastInterviews:r,quizzes:s,total:e+t+r+s}}}catch(e){return console.error("Stats error:",e),{success:!1,message:"Internal server error",status:500}}}async function h(e){try{let e=await S();if(!e.success)return i.NextResponse.json({success:e.success,message:e.message},{status:e.status||500});return i.NextResponse.json(e.data)}catch(e){return console.error("Admin stats API error:",e),i.NextResponse.json({message:"Internal server error"},{status:500})}}let f=(0,u.c2)(h),b=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/stats/route",pathname:"/api/admin/stats",filename:"route",bundlePath:"app/api/admin/stats/route"},resolvedPagePath:"E:\\2.Freelance\\mcqs\\next-js\\app\\api\\admin\\stats\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:v,staticGenerationAsyncStorage:I,serverHooks:q}=b,x="/api/admin/stats/route";function w(){return(0,o.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:I})}},57258:(e,t,r)=>{r.d(t,{c2:()=>n});var s=r(41482),a=r(87070);function n(e){return async(t,r)=>{let n=function(e){let t=e.headers.get("authorization");if(!t||!t.startsWith("Bearer "))return{error:{message:"No token provided"},status:401};let r=t.split(" ")[1];try{let e=s.verify(r,process.env.JWT_SECRET);if("admin"!==e.role)return{error:{message:"Forbidden: Admins only"},status:403};return{user:e}}catch(e){return{error:{message:"Invalid or expired token"},status:401}}}(t);return n.error?a.NextResponse.json(n.error,{status:n.status}):(t.user=n.user,e(t,r))}}},6308:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(11185);r(25163);let a=new s.Schema({question:{type:String,required:!0},options:[{type:String,required:!0}],answer:{type:String,required:!0},explanation:{type:String},categoryId:{type:s.Schema.Types.ObjectId,ref:"Category"},subcategoryId:{type:s.Schema.Types.ObjectId,ref:"Subcategory"},link:{type:String},submittedBy:{type:String},pageOrder:{type:Number,default:0}},{timestamps:!0}),n=s.models.MCQ||s.model("MCQ",a)},12757:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(11185);let a=new s.Schema({title:{type:String,required:!0},year:{type:Number},department:{type:String},pdfUrl:{type:String},categoryId:{type:s.Schema.Types.ObjectId,ref:"Category"},subcategoryId:{type:s.Schema.Types.ObjectId,ref:"Subcategory"}},{timestamps:!0}),n=s.models.PastPaper||s.model("PastPaper",a)},48412:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(11185);let a=new s.Schema({title:{type:String,required:!0},description:{type:String},questions:[{type:s.Schema.Types.ObjectId,ref:"MCQ"}],categoryId:{type:s.Schema.Types.ObjectId,ref:"Category"},subcategoryId:{type:s.Schema.Types.ObjectId,ref:"Subcategory"}},{timestamps:!0}),n=s.models.Quiz||s.model("Quiz",a)},25163:(e,t,r)=>{r.d(t,{Z:()=>o});var s=r(11185);if(!process.env.MONGO_URI)throw Error("Please define the MONGO_URI environment variable inside .env.local");let a=process.env.MONGO_URI,n=global.mongoose;n||(n=global.mongoose={conn:null,promise:null});let o=async function(){if(n.conn)return n.conn;n.promise||(n.promise=s.connect(a,{bufferCommands:!1}).then(e=>e));try{n.conn=await n.promise}catch(e){throw n.promise=null,e}return n.conn}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,1482],()=>r(99654));module.exports=s})();